{
  "hash": "92228960e3e3445f0a21ec6f8bb3d720",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hands-on_Ex04d--- Visualising Models\"\nauthor: \"Li Yuquan\"\ndescription: \"\"\ndate: \"May 5, 2024\"\ndate-modified: \"last-modified\"\nformat: html\neditor: visual\nimage: ../../images/3afm.png\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n# 1 Introduction\n\nIn this section, we will learn how to visualise model diagnostic and model parameters by using parameters package.\n\n# 2 Visual Anaslytics for Building Better Explanatory Models\n\n## 2.1 The case\n\nToyota Corolla case study will be used. The purpose of study is to build a model to discover factors affecting prices of used-cars by taking into consideration a set of explanatory variables.\n\n![](images/image1.jpg)\n\n# 3 Getting Started\n\n:::: panel-tabset\n## Install Packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(readxl, SmartEDA, tidyverse,\n               ggstatsplot, easystats, tidymodels,parameters, see)\n```\n:::\n\n\n\n## Import Data\n\nIn the code chunk below, read_xls() of readxl package is used to import the data worksheet of ToyotaCorolla.xls workbook into R.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_resale <- read_xls(\"data/ToyotaCorolla.xls\", \n                       \"data\")\ncar_resale\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,436 × 38\n      Id Model          Price Age_08_04 Mfg_Month Mfg_Year    KM Fuel_Type    HP\n   <dbl> <chr>          <dbl>     <dbl>     <dbl>    <dbl> <dbl> <chr>     <dbl>\n 1     1 TOYOTA Coroll… 13500        23        10     2002 46986 Diesel       90\n 2     2 TOYOTA Coroll… 13750        23        10     2002 72937 Diesel       90\n 3     3  TOYOTA Corol… 13950        24         9     2002 41711 Diesel       90\n 4     4 TOYOTA Coroll… 14950        26         7     2002 48000 Diesel       90\n 5     5 TOYOTA Coroll… 13750        30         3     2002 38500 Diesel       90\n 6     6 TOYOTA Coroll… 12950        32         1     2002 61000 Diesel       90\n 7     7  TOYOTA Corol… 16900        27         6     2002 94612 Diesel       90\n 8     8 TOYOTA Coroll… 18600        30         3     2002 75889 Diesel       90\n 9     9  TOYOTA Corol… 21500        27         6     2002 19700 Petrol      192\n10    10  TOYOTA Corol… 12950        23        10     2002 71138 Diesel       69\n# ℹ 1,426 more rows\n# ℹ 29 more variables: Met_Color <dbl>, Color <chr>, Automatic <dbl>, CC <dbl>,\n#   Doors <dbl>, Cylinders <dbl>, Gears <dbl>, Quarterly_Tax <dbl>,\n#   Weight <dbl>, Mfr_Guarantee <dbl>, BOVAG_Guarantee <dbl>,\n#   Guarantee_Period <dbl>, ABS <dbl>, Airbag_1 <dbl>, Airbag_2 <dbl>,\n#   Airco <dbl>, Automatic_airco <dbl>, Boardcomputer <dbl>, CD_Player <dbl>,\n#   Central_Lock <dbl>, Powered_Windows <dbl>, Power_Steering <dbl>, …\n```\n\n\n:::\n:::\n\n\n\nNotice that the output object car_resale is a tibble data frame.\n\n## Data Overview\n\n::: panel-tabset\n### summary()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(car_resale)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Id            Model               Price         Age_08_04    \n Min.   :   1.0   Length:1436        Min.   : 4350   Min.   : 1.00  \n 1st Qu.: 361.8   Class :character   1st Qu.: 8450   1st Qu.:44.00  \n Median : 721.5   Mode  :character   Median : 9900   Median :61.00  \n Mean   : 721.6                      Mean   :10731   Mean   :55.95  \n 3rd Qu.:1081.2                      3rd Qu.:11950   3rd Qu.:70.00  \n Max.   :1442.0                      Max.   :32500   Max.   :80.00  \n   Mfg_Month         Mfg_Year          KM          Fuel_Type        \n Min.   : 1.000   Min.   :1998   Min.   :     1   Length:1436       \n 1st Qu.: 3.000   1st Qu.:1998   1st Qu.: 43000   Class :character  \n Median : 5.000   Median :1999   Median : 63390   Mode  :character  \n Mean   : 5.549   Mean   :2000   Mean   : 68533                     \n 3rd Qu.: 8.000   3rd Qu.:2001   3rd Qu.: 87021                     \n Max.   :12.000   Max.   :2004   Max.   :243000                     \n       HP          Met_Color         Color             Automatic      \n Min.   : 69.0   Min.   :0.0000   Length:1436        Min.   :0.00000  \n 1st Qu.: 90.0   1st Qu.:0.0000   Class :character   1st Qu.:0.00000  \n Median :110.0   Median :1.0000   Mode  :character   Median :0.00000  \n Mean   :101.5   Mean   :0.6748                      Mean   :0.05571  \n 3rd Qu.:110.0   3rd Qu.:1.0000                      3rd Qu.:0.00000  \n Max.   :192.0   Max.   :1.0000                      Max.   :1.00000  \n       CC            Doors         Cylinders     Gears       Quarterly_Tax   \n Min.   : 1300   Min.   :2.000   Min.   :4   Min.   :3.000   Min.   : 19.00  \n 1st Qu.: 1400   1st Qu.:3.000   1st Qu.:4   1st Qu.:5.000   1st Qu.: 69.00  \n Median : 1600   Median :4.000   Median :4   Median :5.000   Median : 85.00  \n Mean   : 1577   Mean   :4.033   Mean   :4   Mean   :5.026   Mean   : 87.12  \n 3rd Qu.: 1600   3rd Qu.:5.000   3rd Qu.:4   3rd Qu.:5.000   3rd Qu.: 85.00  \n Max.   :16000   Max.   :5.000   Max.   :4   Max.   :6.000   Max.   :283.00  \n     Weight     Mfr_Guarantee    BOVAG_Guarantee  Guarantee_Period\n Min.   :1000   Min.   :0.0000   Min.   :0.0000   Min.   : 3.000  \n 1st Qu.:1040   1st Qu.:0.0000   1st Qu.:1.0000   1st Qu.: 3.000  \n Median :1070   Median :0.0000   Median :1.0000   Median : 3.000  \n Mean   :1072   Mean   :0.4095   Mean   :0.8955   Mean   : 3.815  \n 3rd Qu.:1085   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.: 3.000  \n Max.   :1615   Max.   :1.0000   Max.   :1.0000   Max.   :36.000  \n      ABS            Airbag_1         Airbag_2          Airco       \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:1.0000   1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :1.0000   Median :1.0000   Median :1.0000   Median :1.0000  \n Mean   :0.8134   Mean   :0.9708   Mean   :0.7228   Mean   :0.5084  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n Automatic_airco   Boardcomputer      CD_Player       Central_Lock   \n Min.   :0.00000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.00000   Median :0.0000   Median :0.0000   Median :1.0000  \n Mean   :0.05641   Mean   :0.2946   Mean   :0.2187   Mean   :0.5801  \n 3rd Qu.:0.00000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:1.0000  \n Max.   :1.00000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n Powered_Windows Power_Steering       Radio          Mistlamps    \n Min.   :0.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.000  \n 1st Qu.:0.000   1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.000  \n Median :1.000   Median :1.0000   Median :0.0000   Median :0.000  \n Mean   :0.562   Mean   :0.9777   Mean   :0.1462   Mean   :0.257  \n 3rd Qu.:1.000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:1.000  \n Max.   :1.000   Max.   :1.0000   Max.   :1.0000   Max.   :1.000  \n  Sport_Model     Backseat_Divider  Metallic_Rim    Radio_cassette  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.0000   Median :1.0000   Median :0.0000   Median :0.0000  \n Mean   :0.3001   Mean   :0.7702   Mean   :0.2047   Mean   :0.1455  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n    Tow_Bar      \n Min.   :0.0000  \n 1st Qu.:0.0000  \n Median :0.0000  \n Mean   :0.2779  \n 3rd Qu.:1.0000  \n Max.   :1.0000  \n```\n\n\n:::\n:::\n\n\n\n### glimpse()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(car_resale)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 1,436\nColumns: 38\n$ Id               <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16…\n$ Model            <chr> \"TOYOTA Corolla 2.0 D4D HATCHB TERRA 2/3-Doors\", \"TOY…\n$ Price            <dbl> 13500, 13750, 13950, 14950, 13750, 12950, 16900, 1860…\n$ Age_08_04        <dbl> 23, 23, 24, 26, 30, 32, 27, 30, 27, 23, 25, 22, 25, 3…\n$ Mfg_Month        <dbl> 10, 10, 9, 7, 3, 1, 6, 3, 6, 10, 8, 11, 8, 2, 1, 5, 3…\n$ Mfg_Year         <dbl> 2002, 2002, 2002, 2002, 2002, 2002, 2002, 2002, 2002,…\n$ KM               <dbl> 46986, 72937, 41711, 48000, 38500, 61000, 94612, 7588…\n$ Fuel_Type        <chr> \"Diesel\", \"Diesel\", \"Diesel\", \"Diesel\", \"Diesel\", \"Di…\n$ HP               <dbl> 90, 90, 90, 90, 90, 90, 90, 90, 192, 69, 192, 192, 19…\n$ Met_Color        <dbl> 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1,…\n$ Color            <chr> \"Blue\", \"Silver\", \"Blue\", \"Black\", \"Black\", \"White\", …\n$ Automatic        <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ CC               <dbl> 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 1800,…\n$ Doors            <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,…\n$ Cylinders        <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,…\n$ Gears            <dbl> 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 5, 5,…\n$ Quarterly_Tax    <dbl> 210, 210, 210, 210, 210, 210, 210, 210, 100, 185, 100…\n$ Weight           <dbl> 1165, 1165, 1165, 1165, 1170, 1170, 1245, 1245, 1185,…\n$ Mfr_Guarantee    <dbl> 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0,…\n$ BOVAG_Guarantee  <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,…\n$ Guarantee_Period <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 12, 3, 3, 3, 3, 3, 3, 1…\n$ ABS              <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ Airbag_1         <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ Airbag_2         <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0,…\n$ Airco            <dbl> 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ Automatic_airco  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0,…\n$ Boardcomputer    <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0,…\n$ CD_Player        <dbl> 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0,…\n$ Central_Lock     <dbl> 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ Powered_Windows  <dbl> 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ Power_Steering   <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ Radio            <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1,…\n$ Mistlamps        <dbl> 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0,…\n$ Sport_Model      <dbl> 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0,…\n$ Backseat_Divider <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0,…\n$ Metallic_Rim     <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0,…\n$ Radio_cassette   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1,…\n$ Tow_Bar          <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,…\n```\n\n\n:::\n:::\n\n\n\n### head()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(car_resale,100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 100 × 38\n      Id Model          Price Age_08_04 Mfg_Month Mfg_Year    KM Fuel_Type    HP\n   <dbl> <chr>          <dbl>     <dbl>     <dbl>    <dbl> <dbl> <chr>     <dbl>\n 1     1 TOYOTA Coroll… 13500        23        10     2002 46986 Diesel       90\n 2     2 TOYOTA Coroll… 13750        23        10     2002 72937 Diesel       90\n 3     3  TOYOTA Corol… 13950        24         9     2002 41711 Diesel       90\n 4     4 TOYOTA Coroll… 14950        26         7     2002 48000 Diesel       90\n 5     5 TOYOTA Coroll… 13750        30         3     2002 38500 Diesel       90\n 6     6 TOYOTA Coroll… 12950        32         1     2002 61000 Diesel       90\n 7     7  TOYOTA Corol… 16900        27         6     2002 94612 Diesel       90\n 8     8 TOYOTA Coroll… 18600        30         3     2002 75889 Diesel       90\n 9     9  TOYOTA Corol… 21500        27         6     2002 19700 Petrol      192\n10    10  TOYOTA Corol… 12950        23        10     2002 71138 Diesel       69\n# ℹ 90 more rows\n# ℹ 29 more variables: Met_Color <dbl>, Color <chr>, Automatic <dbl>, CC <dbl>,\n#   Doors <dbl>, Cylinders <dbl>, Gears <dbl>, Quarterly_Tax <dbl>,\n#   Weight <dbl>, Mfr_Guarantee <dbl>, BOVAG_Guarantee <dbl>,\n#   Guarantee_Period <dbl>, ABS <dbl>, Airbag_1 <dbl>, Airbag_2 <dbl>,\n#   Airco <dbl>, Automatic_airco <dbl>, Boardcomputer <dbl>, CD_Player <dbl>,\n#   Central_Lock <dbl>, Powered_Windows <dbl>, Power_Steering <dbl>, …\n```\n\n\n:::\n:::\n\n\n:::\n::::\n\n## 3.1 Multiple Regression Model using lm()\n\nThe code chunk below is used to calibrate a multiple linear regression model by using lm() of Base Stats of R.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(Price ~ Age_08_04 + Mfg_Year + KM + \n              Weight + Guarantee_Period, data = car_resale)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Price ~ Age_08_04 + Mfg_Year + KM + Weight + Guarantee_Period, \n    data = car_resale)\n\nCoefficients:\n     (Intercept)         Age_08_04          Mfg_Year                KM  \n      -2.637e+06        -1.409e+01         1.315e+03        -2.323e-02  \n          Weight  Guarantee_Period  \n       1.903e+01         2.770e+01  \n```\n\n\n:::\n:::\n\n\n\n## 3.2 Model Diagnostic: checking for multicolinearity:\n\nIn the code chunk, [*check_collinearity()*](https://easystats.github.io/performance/reference/check_collinearity.html) of [**performance**](https://easystats.github.io/performance/index.html) package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_collinearity(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Check for Multicollinearity\n\nLow Correlation\n\n             Term  VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n               KM 1.46 [ 1.37,  1.57]         1.21      0.68     [0.64, 0.73]\n           Weight 1.41 [ 1.32,  1.51]         1.19      0.71     [0.66, 0.76]\n Guarantee_Period 1.04 [ 1.01,  1.17]         1.02      0.97     [0.86, 0.99]\n\nHigh Correlation\n\n      Term   VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n Age_08_04 31.07 [28.08, 34.38]         5.57      0.03     [0.03, 0.04]\n  Mfg_Year 31.16 [28.16, 34.48]         5.58      0.03     [0.03, 0.04]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_c <- check_collinearity(model)\nplot(check_c)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04d_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## 3.3 Model Diagnostic: checking normality assumption\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(Price ~ Age_08_04 + KM + \n              Weight + Guarantee_Period, data = car_resale)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_n <- check_normality(model1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_n)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04d_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## 3.4 Model Diagnostic: Check model for homogeneity of variances\n\nIn the code chunk, [*check_heteroscedasticity()*](https://easystats.github.io/performance/reference/check_heteroscedasticity.html) of [**performance**](https://easystats.github.io/performance/index.html) package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_h <- check_heteroscedasticity(model1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_h)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04d_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n## 3.5 Model Diagnostic: Complete check\n\nWe can also perform the complete by using [*check_model()*](https://easystats.github.io/performance/reference/check_model.html).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_model(model1)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04d_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n## 3.6 Visualising Regression Parameters: see methods\n\nIn the code below, plot() of see package and parameters() of parameters package is used to visualise the parameters of a regression model.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot(parameters(model1))\n```\n:::\n\n\n\n## 3.7 Visualising Regression Parameters: ggcoefstats() methods\n\nIn the code below, [*ggcoefstats()*](https://indrajeetpatil.github.io/ggstatsplot/reference/ggcoefstats.html) of ggstatsplot package to visualise the parameters of a regression model.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcoefstats(model1, \n            output = \"plot\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04d_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Hands-on_Ex04d_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}