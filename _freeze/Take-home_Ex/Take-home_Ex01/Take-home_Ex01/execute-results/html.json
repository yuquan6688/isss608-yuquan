{
  "hash": "de8da5d13ba47b7f0970e9832265fd14",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1\"\nsubtitle: \"Visual Analytics of Population Structure Across Different Planning Areas in Singapore\"\nauthor: \"Li Yuquan\"\ndescription: \"\"\ndate: \"April 30, 2024\"\ndate-modified: \"last-modified\"\nformat: html\nimage: images/fm.png\neditor: visual\n\n\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n![](images/fm.png)\n\n# 1 Overview\n\n## 1.1 Setting the scene\n\nA local online media company that publishes daily content on digital platforms is planning to release an article in 2024 focusing on the population structure and distribution of Singapore. The number of resident population is a key indicator in understanding population structure, as it helps analyze aspects such as age composition, gender ratio, regional population density, and developmental disparities. This study aims to explore the differences in Singapore’s population structure and distribution through the organization and visual representation of such data.\n\n## 1.2 Objectives\n\nAs a graphical editor of a median company, I conduct exploratory data analysis and visualize the data from the following three aspects:\n\n1.  **Age Group Composition across Planning Areas**\n\n    Identify spatial disparities in youth, middle-aged, and elderly population distribution to reveal areas with aging or younger communities.\n\n2.  **Gender Distribution and Elderly Gender Imbalance**\n\n    Explore male-female ratios and highlight significant gender differences in the elderly population across planning areas.\n\n3.  **Regional Demographics by Age and Gender**\n\n    Compare age and gender structures across five major regions to uncover regional demographic trends and planning implications.\n\n# 2 Data pre-processing & data exploration\n\n## 2.1 Dataset Overview\n\nThe dataset used for this analysis is “Singapore Resident Population by Planning Area/Subzone, Single Year of Age and Sex, June 2024,” published by the Singapore Department of Statistics (DOS) on <https://www.singstat.gov.sg>. The data covers all planning areas and subzones across the Singapore, listing the number of resident population (Residents) by age and sex.\n\n## 2.2 Loading R packages\n\n| Library | Purpose |\n|------------------------------------|------------------------------------|\n|  `tidyverse`  | Include dplyr for data manipulation (mutate, group_by, summarize), ggplot2 for visualization (histograms, boxplots), and forcats for factor handling and variable ordering |\n|  `ggrepel`  | an R package provides geoms for ggplot2 to repel overlapping text labels |\n|  `ggthemes`  | an R package provides some extra themes, geoms, and scales for ‘ggplot2’ |\n|  `hrbrthemes`  | an R package provides typography-centric themes and theme components for ggplot2 |\n|  `patchwork`  | an R package for preparing composite figure created using ggplot2 |\n|  `ggdist`  | an R package for visualisation of distributions and uncertainity. |\n|  `ggridges`  | an R package for creating density plots for visualisation of continuous distribution. |\n|  `forcats`  | an R package for working with categorical variables (factors), including tools for reordering and modifying factor levels |\n|  `viridis`  | an R package providing color scales that are perceptually uniform |\n|  `scales`  | an R package providing tools to customize axis labels, legends, and formatting in visualizations |\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork, \n               ggthemes, hrbrthemes,\n               tidyverse, ggdist, ggridges, forcats, viridis, scales\n) \n```\n:::\n\n\n\n## 2.3 Importing the data\n\nThe dataset used in this study is in CSV format. The dataset is imported using the  `read_csv()`  function and is named as \"data\".\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read_csv(\"data/respopagesex2024.csv\")\n```\n:::\n\n\n\n## 2.4 Data exploration\n\n### 2.4.1 Overview of Data Structure and Statistics\n\nExplore the basic information of the dataset by using  `summary()` ,  `glimpse()`  and  `file.info()` . The dataset contains 60,424 observations and 6 variables, describing population counts disaggregated by planning areas, subzones, age groups, sex, and time (year).The size of the dataset is 2.5MB.\n\n| Variable | Description |\n|------------------------------------|------------------------------------|\n| `PA (Planning Area)` | Character variable indicating planning areas |\n| `SZ (Subzone)` | Character variable indicating subzones |\n| `Age` | Character variable representing age groups |\n| `Sex` | Character variable indicating gender |\n| `Pop` | Numeric variable (`<dbl>`) representing the population count. |\n| `Time` | Numeric variable (`<dbl>`) indicating the year, with all values are 2024. |\n\n::: panel-tabset\n#### summary()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      PA                 SZ                Age                Sex           \n Length:60424       Length:60424       Length:60424       Length:60424      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n      Pop              Time     \n Min.   :   0.0   Min.   :2024  \n 1st Qu.:   0.0   1st Qu.:2024  \n Median :  20.0   Median :2024  \n Mean   :  69.4   Mean   :2024  \n 3rd Qu.:  90.0   3rd Qu.:2024  \n Max.   :1180.0   Max.   :2024  \n```\n\n\n:::\n:::\n\n\n\n#### glimpse()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 60,424\nColumns: 6\n$ PA   <chr> \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo K…\n$ SZ   <chr> \"Ang Mo Kio Town Centre\", \"Ang Mo Kio Town Centre\", \"Ang Mo Kio T…\n$ Age  <chr> \"0\", \"0\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", \"4\", \"4\", \"5\", \"5\", \"6\", …\n$ Sex  <chr> \"Males\", \"Females\", \"Males\", \"Females\", \"Males\", \"Females\", \"Male…\n$ Pop  <dbl> 10, 10, 10, 10, 10, 10, 10, 10, 30, 10, 20, 10, 20, 30, 30, 10, 3…\n$ Time <dbl> 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024,…\n```\n\n\n:::\n:::\n\n\n\n#### file size\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfile.info(\"data/respopagesex2024.csv\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                             size isdir mode               mtime\ndata/respopagesex2024.csv 2521616 FALSE  644 2024-09-23 17:44:00\n                                        ctime               atime uid gid\ndata/respopagesex2024.csv 2025-05-02 17:13:57 2025-05-04 17:36:18 501  20\n                             uname grname\ndata/respopagesex2024.csv liyuquan  staff\n```\n\n\n:::\n:::\n\n\n:::\n\n### 2.4.2 Check missing value\n\nMap all possible null values in the data to NA. Use  `is.na`  to check the data and output FALSE, indicating that there are no missing values in the dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata[data == \"\"] <- NA\nany(is.na(data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n\n### 2.4.3 Check for duplication\n\nUsing the `duplicated` function, the output is \"\\# A tibble: 0 × 6\", which indicates that there are no duplicate entries in the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata[duplicated(data),]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 0 × 6\n# ℹ 6 variables: PA <chr>, SZ <chr>, Age <chr>, Sex <chr>, Pop <dbl>,\n#   Time <dbl>\n```\n\n\n:::\n:::\n\n\n\n## 2.5 Data pre-processing\n\n### 2.5.1 Convert data type\n\nIn the original dataset, the data type of the Age variable is `character`. Among them, there is data \"90_and_Over\". We will replace this data with \"90\" and convert the data type of this variable to `numeric`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- data %>%\n  mutate(\n    Age = if_else(Age == \"90_and_Over\", \"90\", as.character(Age)),\n    Age = as.numeric(Age)\n  )\n```\n:::\n\n\n\n### 2.5.2 Construct new variable\n\n#### 2.5.2.1 Grouped by broad age categories → v1 → Age_Group\n\nUse `mutate()` to create a new variable and apply `case_when()` to categorize the values of Age into three groups: Youth (0–21 years), Middle (22–64 years), and Elderly (65–90 years).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv1 <- data1 %>%\n  mutate(\n    Age_Group = case_when(\n      Age <= 21 ~ \"Youth\",\n      Age < 65 ~ \"Middle\",\n      TRUE ~ \"Elderly\"\n    )\n  )\n```\n:::\n\n\n\n#### 2.5.2.2 Grouped by fine-grained 5-year age intervals → v2 → Age_Group\n\nUse `mutate()` to create a new variable and apply `cut()` to bin the Age data into 5-year intervals from 0 to 89 years, with an additional group at the end labeled as “90_and_over” for ages 90 and above.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv2 <- data1 %>%\n  mutate(\n    Age_Group = cut(\n      Age,\n      breaks = c(seq(0, \n                     90, \n                     by = 5), \n                 Inf),\n      right = FALSE,\n      labels = c(\n        \"00_to_04\", \"05_to_09\", \"10_to_14\", \"15_to_19\", \"20_to_24\",\n        \"25_to_29\", \"30_to_34\", \"35_to_39\", \"40_to_44\", \"45_to_49\",\n        \"50_to_54\", \"55_to_59\", \"60_to_64\", \"65_to_69\", \"70_to_74\",\n        \"75_to_79\", \"80_to_84\", \"85_to_89\", \"90_and_over\"\n      )\n    )\n  )\n```\n:::\n\n\n\n#### 2.5.2.3 Group the planning areas by regions → v3_region → region\n\nUse `tribble()` to categorize the 55 planning areas (PA) in the original dataset into five regions: West, Central, East, North, and North-East. Name this new variable Region, and use `left_join()` to merge the resulting table into the v3_region dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nregion_mapping <- tribble(\n  ~PA,                     ~Region,\n  # Central\n  \"Bishan\",                \"Central\",\n  \"Bukit Merah\",          \"Central\",\n  \"Bukit Timah\",          \"Central\",\n  \"Downtown Core\",        \"Central\",\n  \"Geylang\",              \"Central\",\n  \"Kallang\",              \"Central\",\n  \"Marina East\",          \"Central\",\n  \"Marina South\",         \"Central\",\n  \"Marine Parade\",        \"Central\",\n  \"Museum\",               \"Central\",\n  \"Newton\",               \"Central\",\n  \"Novena\",               \"Central\",\n  \"Orchard\",              \"Central\",\n  \"Outram\",               \"Central\",\n  \"Queenstown\",           \"Central\",\n  \"River Valley\",         \"Central\",\n  \"Rochor\",               \"Central\",\n  \"Singapore River\",      \"Central\",\n  \"Southern Islands\",     \"Central\",\n  \"Straits View\",         \"Central\",\n  \"Tanglin\",              \"Central\",\n  \"Toa Payoh\",            \"Central\",\n\n  # East\n  \"Bedok\",                \"East\",\n  \"Changi\",               \"East\",\n  \"Changi Bay\",           \"East\",\n  \"Pasir Ris\",            \"East\",\n  \"Paya Lebar\",           \"East\",\n  \"Tampines\",             \"East\",\n\n  # North\n  \"Central Water Catchment\", \"North\",\n  \"Lim Chu Kang\",            \"North\",\n  \"Mandai\",                  \"North\",\n  \"Sembawang\",               \"North\",\n  \"Simpang\",                 \"North\",\n  \"Sungei Kadut\",            \"North\",\n  \"Woodlands\",               \"North\",\n  \"Yishun\",                  \"North\",\n\n  # North-East\n  \"Ang Mo Kio\",             \"North-East\",\n  \"Hougang\",                \"North-East\",\n  \"North-Eastern Islands\",  \"North-East\",\n  \"Punggol\",                \"North-East\",\n  \"Seletar\",                \"North-East\",\n  \"Sengkang\",               \"North-East\",\n  \"Serangoon\",              \"North-East\",\n\n  # West\n  \"Boon Lay\",               \"West\",\n  \"Bukit Batok\",            \"West\",\n  \"Bukit Panjang\",          \"West\",\n  \"Choa Chu Kang\",          \"West\",\n  \"Clementi\",               \"West\",\n  \"Jurong East\",            \"West\",\n  \"Jurong West\",            \"West\",\n  \"Pioneer\",                \"West\",\n  \"Tengah\",                 \"West\",\n  \"Tuas\",                   \"West\",\n  \"Western Islands\",        \"West\",\n  \"Western Water Catchment\",\"West\"\n)\n\nv3_region <- data1 %>%\n  left_join(region_mapping, by = \"PA\") %>%\n  filter(!is.na(Region))\n```\n:::\n\n\n\n### 2.5.3 Data prepare for Visualization\n\n#### 2.5.3.1 Data prepare for Visualization 3.1\n\n::: panel-tabset\n##### Description\n\n`v1_grouped_all` summarizes the total population counts and corresponding ratios of the Elderly (≥ 65), Youth (≤ 21), and Middle-aged (22–64) groups for each Planning Area (PA). It ensures that only areas with valid computed ratios for all three groups are retained, forming the analytical base for plots p1, p2, and p3.\n\nThe `top_bottom_elderly`, `top_bottom_youth`, and `top_bottom_middle` subsets extract the top and bottom 10 Planning Areas based on the proportions of elderly, youth, and middle-aged populations respectively, with the PA factor reordered by each corresponding age group ratio to facilitate ranked comparisons in plots p1, p2, and p3.\n\n`v1_p4` prepares the full age group composition by Planning Area for visualization in plot p4. It calculates the population share (Ratio) of each age group within each PA. Additionally, each PA is sorted by the ratio of middle-aged residents, and the PA variable is re-leveled accordingly to ensure consistent display order.\n\n`v1_p5` dataset calculates the overall proportion of each age group across Singapore, and derives variables (xmin, xmax, label_x) to position percentage labels for a horizontal stacked visualization.\n\n##### The Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv1_grouped_all <- v1 %>%\n  group_by(PA) %>%\n  summarise(\n    Elderly = sum(Pop[Age >= 65], \n                  na.rm = TRUE),\n    Youth = sum(Pop[Age <= 21], \n                na.rm = TRUE),\n    Middle = sum(Pop[Age > 21 & Age < 65], \n                 na.rm = TRUE),\n    Total = sum(Pop, \n                na.rm = TRUE),\n    Elderly_Rate = Elderly / Total,\n    Youth_Rate = Youth / Total,\n    Middle_Rate = Middle / Total,\n    .groups = \"drop\"\n  ) %>%\n  filter(!is.na(Elderly_Rate) & !is.na(Youth_Rate) & !is.na(Middle_Rate))\n\n# filter top_bottom for p1 p2 p3\ntop_bottom_elderly <- bind_rows(\n  slice_max(v1_grouped_all, \n            Elderly_Rate, \n            n = 10),\n  slice_min(v1_grouped_all, \n            Elderly_Rate, \n            n = 10)\n) %>%\n  mutate(PA = fct_reorder(PA, \n                          Elderly_Rate))\n\ntop_bottom_youth <- bind_rows(\n  slice_max(v1_grouped_all, \n            Youth_Rate, \n            n = 10),\n  slice_min(v1_grouped_all, \n            Youth_Rate, \n            n = 10)\n) %>%\n  mutate(PA = fct_reorder(PA, \n                          Youth_Rate))\n\ntop_bottom_middle <- bind_rows(\n  slice_max(v1_grouped_all, \n            Middle_Rate, \n            n = 10),\n  slice_min(v1_grouped_all, \n            Middle_Rate, \n            n = 10)\n) %>%\n  mutate(PA = fct_reorder(PA, \n                          Middle_Rate))\n\n# p4\nv1_p4 <- v1 %>%\n  group_by(PA, Age_Group) %>%\n  summarise(Pop = sum(Pop, na.rm = TRUE), .groups = \"drop\") %>%\n  group_by(PA) %>%\n  mutate(\n    Total = sum(Pop),\n    Ratio = Pop / Total\n  ) %>%\n  filter(Total > 0) %>%\n  select(-Total) %>%\n  ungroup() %>%\n  group_by(PA) %>%\n  mutate(Middle_Ratio = Ratio[Age_Group == \"Middle\"]) %>%\n  ungroup() %>%\n  arrange(desc(Middle_Ratio)) %>%\n  mutate(PA = factor(PA, levels = unique(PA))) %>%\n  select(-Middle_Ratio)\n\n# p5\nv1_p5 <- v1 %>%\n  group_by(Age_Group) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\") %>%\n  mutate(\n    Prop = Pop / sum(Pop),\n    Percent = paste0(Age_Group, \": \", \n                     round(Prop * 100, 1), \n                     \"%\"),\n    xmin = cumsum(lag(Prop, default = 0)),\n    xmax = cumsum(Prop),\n    label_x = (xmin + xmax) / 2\n  )\n```\n:::\n\n\n:::\n\n#### 2.5.3.2 data prepare for Visualization 3.2\n\n::: panel-tabset\n##### Description\n\n`v2_p6` calculates the total population of males and females across different age groups, along with their respective proportions of the total population. It assigns mirrored percentage values by gender (positive for males, negative for females) to prepare for the construction of a population pyramid. This approach facilitates the comparison of gender distribution across age groups.\n\n`v2_p7` calculates the gender-specific population count for each Planning Area (PA) and computes the proportion of each gender within the area’s total population. For visualization purposes, Percent_plot is mirrored (positive for males, negative for females), and the PA variable is reordered based on total population to support meaningful comparative plotting.\n\n`v2_p8` computes the elderly population ratio (aged ≥ 65) for both males and females in each Planning Area. It mirrors the values for plotting (positive for males, negative for females), filters out regions with zero elderly population, and selects the top and bottom 10 PA based on elderly population share. These selected areas are used to compare gender differences in aging patterns.\n\n##### The Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# p6\nv2_p6 <- v2 %>%\n  group_by(Sex, Age_Group) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\") %>%\n  mutate(\n    Percent = Pop / sum(Pop) * 100,\n    Percent_plot = ifelse(Sex == \"Males\", \n                          Percent, \n                          -Percent)\n  )\n\n# p7\nv2_p7 <- v2 %>%\n  group_by(PA, Sex) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\")\n\ntotal_pa <- v2_p7 %>%\n  group_by(PA) %>%\n  summarise(Total = sum(Pop), .groups = \"drop\")\n\nv2_p7 <- left_join(v2_p7, \n                   total_pa, \n                   by = \"PA\") %>%\n  mutate(\n    Percent = Pop / Total * 100,\n    Percent_plot = ifelse(Sex == \"Males\", \n                          Percent, \n                          -Percent)\n  ) %>%\n  group_by(PA) %>%\n  filter(sum(Pop) > 0) %>%\n  ungroup() %>%\n  mutate(PA = fct_reorder(PA, Total))\n\n# p8\nv2_p8 <- v2 %>%\n  group_by(PA, Sex) %>%\n  summarise(\n    Total = sum(Pop, na.rm = TRUE),\n    Elderly = sum(Pop[Age >= 65], na.rm = TRUE),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    Elderly_Rate = ifelse(Total > 0, \n                          Elderly / Total * 100, 0),\n    Elderly_Rate_plot = ifelse(Sex == \"Males\", \n                               Elderly_Rate, \n                               -Elderly_Rate)\n  )\n\nvalid_PA <- v2_p8 %>%\n  group_by(PA) %>%\n  summarise(Total_Elderly = sum(Elderly)) %>%\n  filter(Total_Elderly > 0) %>%\n  pull(PA)\n\nv2_p8 <- v2_p8 %>% filter(PA %in% valid_PA)\n\npa_avg <- v2_p8 %>%\n  group_by(PA) %>%\n  summarise(Avg_Elderly_Rate = mean(Elderly_Rate), .groups = \"drop\")\n\nselected_PA <- bind_rows(\n  slice_max(pa_avg, \n            Avg_Elderly_Rate, \n            n = 10),\n  slice_min(pa_avg, \n            Avg_Elderly_Rate, \n            n = 10)\n) %>%\n  arrange(desc(Avg_Elderly_Rate)) %>%\n  pull(PA)\n\nv2_p8 <- v2_p8 %>%\n  filter(PA %in% selected_PA) %>%\n  mutate(PA = factor(PA, levels = rev(selected_PA)))\n```\n:::\n\n\n:::\n\n#### 2.5.3.3 data prepare for Visualization 3.3\n\n::: panel-tabset\n##### Description\n\n`v3_p9`This dataset aggregates the total population by region and calculates each region’s percentage share of the overall population. A new Label column is also created to display the region name, total population , and its percentage share.\n\n`v3_p10` expands the original region-level aggregated population data into individual-level rows, where each row represents a single person.\n\n`v3_p11` draws approximately 0.07% of the data by region and sex as a sample, in order to support visually cleaner and more efficient distribution visualizations.\n\n`v3_points` extracts a further small sample (0.02%) from the full individual-level dataset, stratified by Region and Age. A numeric mapping of Region is added (Region_numeric) to enable vertical jittering in visualizations by numerical y-position.\n\n##### The Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv3_p9 <- v3_region %>%\n  group_by(Region) %>%\n  summarise(Total_Pop = sum(Pop, na.rm = TRUE)) %>%\n  mutate(\n    Percent = Total_Pop / sum(Total_Pop) * 100,\n    Label = paste0(Region, \"\\n\", comma(Total_Pop), \"\\n\", round(Percent, 1), \"%\")\n  )\n\nv3_p10 <- v3_region %>%\n  uncount(weights = Pop)\n\nv3_p11 <- v3_p10 %>%\n  group_by(Region, Sex) %>%\n  sample_frac(0.0007)\n\nv3_ridges <- v3_p10 \nv3_points <- v3_p10 %>%\n  group_by(Region, Age) %>%\n  sample_frac(0.0002)\nregion_levels <- levels(fct_rev(factor(v3_ridges$Region)))\nv3_points <- v3_points %>%\n  mutate(Region_numeric = match(Region, region_levels))\n```\n:::\n\n\n:::\n\n### 2.5.4 Preview pre-processed data\n\nUse `head()` to display the first 200 rows of the data. By viewing the processed data, we can observe that new variables have been added to the corresponding data sets.\n\n::: panel-tabset\n#### data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(data, 200)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 200 × 6\n   PA         SZ                     Age   Sex       Pop  Time\n   <chr>      <chr>                  <chr> <chr>   <dbl> <dbl>\n 1 Ang Mo Kio Ang Mo Kio Town Centre 0     Males      10  2024\n 2 Ang Mo Kio Ang Mo Kio Town Centre 0     Females    10  2024\n 3 Ang Mo Kio Ang Mo Kio Town Centre 1     Males      10  2024\n 4 Ang Mo Kio Ang Mo Kio Town Centre 1     Females    10  2024\n 5 Ang Mo Kio Ang Mo Kio Town Centre 2     Males      10  2024\n 6 Ang Mo Kio Ang Mo Kio Town Centre 2     Females    10  2024\n 7 Ang Mo Kio Ang Mo Kio Town Centre 3     Males      10  2024\n 8 Ang Mo Kio Ang Mo Kio Town Centre 3     Females    10  2024\n 9 Ang Mo Kio Ang Mo Kio Town Centre 4     Males      30  2024\n10 Ang Mo Kio Ang Mo Kio Town Centre 4     Females    10  2024\n# ℹ 190 more rows\n```\n\n\n:::\n:::\n\n\n\n#### v1\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(v1,200)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 200 × 7\n   PA         SZ                       Age Sex       Pop  Time Age_Group\n   <chr>      <chr>                  <dbl> <chr>   <dbl> <dbl> <chr>    \n 1 Ang Mo Kio Ang Mo Kio Town Centre     0 Males      10  2024 Youth    \n 2 Ang Mo Kio Ang Mo Kio Town Centre     0 Females    10  2024 Youth    \n 3 Ang Mo Kio Ang Mo Kio Town Centre     1 Males      10  2024 Youth    \n 4 Ang Mo Kio Ang Mo Kio Town Centre     1 Females    10  2024 Youth    \n 5 Ang Mo Kio Ang Mo Kio Town Centre     2 Males      10  2024 Youth    \n 6 Ang Mo Kio Ang Mo Kio Town Centre     2 Females    10  2024 Youth    \n 7 Ang Mo Kio Ang Mo Kio Town Centre     3 Males      10  2024 Youth    \n 8 Ang Mo Kio Ang Mo Kio Town Centre     3 Females    10  2024 Youth    \n 9 Ang Mo Kio Ang Mo Kio Town Centre     4 Males      30  2024 Youth    \n10 Ang Mo Kio Ang Mo Kio Town Centre     4 Females    10  2024 Youth    \n# ℹ 190 more rows\n```\n\n\n:::\n:::\n\n\n\n#### v2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(v2,200)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 200 × 7\n   PA         SZ                       Age Sex       Pop  Time Age_Group\n   <chr>      <chr>                  <dbl> <chr>   <dbl> <dbl> <fct>    \n 1 Ang Mo Kio Ang Mo Kio Town Centre     0 Males      10  2024 00_to_04 \n 2 Ang Mo Kio Ang Mo Kio Town Centre     0 Females    10  2024 00_to_04 \n 3 Ang Mo Kio Ang Mo Kio Town Centre     1 Males      10  2024 00_to_04 \n 4 Ang Mo Kio Ang Mo Kio Town Centre     1 Females    10  2024 00_to_04 \n 5 Ang Mo Kio Ang Mo Kio Town Centre     2 Males      10  2024 00_to_04 \n 6 Ang Mo Kio Ang Mo Kio Town Centre     2 Females    10  2024 00_to_04 \n 7 Ang Mo Kio Ang Mo Kio Town Centre     3 Males      10  2024 00_to_04 \n 8 Ang Mo Kio Ang Mo Kio Town Centre     3 Females    10  2024 00_to_04 \n 9 Ang Mo Kio Ang Mo Kio Town Centre     4 Males      30  2024 00_to_04 \n10 Ang Mo Kio Ang Mo Kio Town Centre     4 Females    10  2024 00_to_04 \n# ℹ 190 more rows\n```\n\n\n:::\n:::\n\n\n\n#### v3_region\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(v3_region,200)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 200 × 7\n   PA         SZ                       Age Sex       Pop  Time Region    \n   <chr>      <chr>                  <dbl> <chr>   <dbl> <dbl> <chr>     \n 1 Ang Mo Kio Ang Mo Kio Town Centre     0 Males      10  2024 North-East\n 2 Ang Mo Kio Ang Mo Kio Town Centre     0 Females    10  2024 North-East\n 3 Ang Mo Kio Ang Mo Kio Town Centre     1 Males      10  2024 North-East\n 4 Ang Mo Kio Ang Mo Kio Town Centre     1 Females    10  2024 North-East\n 5 Ang Mo Kio Ang Mo Kio Town Centre     2 Males      10  2024 North-East\n 6 Ang Mo Kio Ang Mo Kio Town Centre     2 Females    10  2024 North-East\n 7 Ang Mo Kio Ang Mo Kio Town Centre     3 Males      10  2024 North-East\n 8 Ang Mo Kio Ang Mo Kio Town Centre     3 Females    10  2024 North-East\n 9 Ang Mo Kio Ang Mo Kio Town Centre     4 Males      30  2024 North-East\n10 Ang Mo Kio Ang Mo Kio Town Centre     4 Females    10  2024 North-East\n# ℹ 190 more rows\n```\n\n\n:::\n:::\n\n\n:::\n\n# 3 Data Visualization\n\n## 3.1 Population Age Structure Across Singapore Planning Areas\n\nThis data visualisation presents the age structure of Singapore’s resident population across different planning areas, divided into three categories: Youth (aged 21 and below), Middle-aged (22 to 64), and Elderly (65 and above).\n\n::: panel-tabset\n### The Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n\n### The Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# common theme\ncommon_theme <- theme(\n  plot.title = element_text(size = 10, \n                            face = \"bold\", \n                            hjust = 0),\n  axis.text.y = element_text(size = 7),\n  legend.position = \"right\"\n)\n\n# elderly plot\np1 <- ggplot(top_bottom_elderly, aes(x = Elderly_Rate, \n                                     y = PA, \n                                     fill = Elderly_Rate)) +\n  geom_col() +\n  xlim(0, 0.35) +\n  scale_fill_viridis_c(option = \"C\") +\n  labs(\n    title = \"Top 10 & Bottom 10 Areas by Elderly Rate (≥ 65)\",\n    x = \"Elderly Ratio\",\n    y = \"Planning Area\"\n  ) +\n  theme_minimal() +\n  common_theme\n\n# youth plot\np2 <- ggplot(top_bottom_youth, aes(x = Youth_Rate, \n                                   y = PA, \n                                   fill = Youth_Rate)) +\n  geom_col() +\n  xlim(0, 0.35) +\n  scale_fill_viridis_c(option = \"C\") +\n  labs(\n    title = \"Top 10 & Bottom 10 Areas by Youth Rate (≤ 21)\",\n    x = \"Youth Ratio\",\n    y = \"Planning Area\"\n  ) +\n  theme_minimal() +\n  common_theme\n\n# middle plot\np3 <- ggplot(top_bottom_middle, aes(x = Middle_Rate, y = PA, fill = Middle_Rate)) +\n  geom_col() +\n  xlim(0, 1) +\n  scale_fill_viridis_c(option = \"C\") +\n  labs(\n    title = \"Top 10 & Bottom 10 Areas by Middle-aged Rate (22-64)\",\n    x = \"Middle-aged Ratio\",\n    y = \"Planning Area\"\n  ) +\n  theme_minimal() +\n  common_theme\n\n# Plot for each area\np4 <- ggplot(v1_p4, aes(x = PA, \n                        y = Ratio, \n                        fill = Age_Group)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(\n    title = \"Age Group Composition by Planning Area\",\n    x = \"Planning Area\",\n    y = \"Population Ratio\"\n  ) +\n  scale_fill_viridis_d(option = \"C\", \n                       begin = 0.2, \n                       end = 0.9) +\n  theme_minimal() +\n  common_theme\n\n# Total Plot \np5 <- ggplot(v1_p5) +\n  geom_rect(aes(xmin = xmin, xmax = xmax, ymin = 0, ymax = 1, fill = Age_Group)) +\n  geom_text(aes(x = label_x, \n                y = 0.5, \n                label = Percent), \n            color = \"white\", size = 3, \n            fontface = \"bold\") +\n  scale_fill_manual(values = c(\"Youth\" = \"#FDD75E\", \n                               \"Middle\" = \"#C94C5C\", \n                               \"Elderly\" = \"#5626A6\")) +\n  coord_cartesian(ylim = c(0, 1)) +\n  theme_void() +\n  ggtitle(\"Total Age Group Composition\") +\n  theme(\n    aspect.ratio = 0.05,  \n    plot.title = element_text(hjust = 0.5, \n                              size = 10, \n                              face = \"bold\"),\n    plot.margin = margin(0.2, 0.5, 0.2, 0.5, \n                         unit = \"cm\"),\n    legend.position = \"none\"\n  )\n\n\n\np5 / ((p1 / p2 / p3) | p4)\n```\n:::\n\n\n:::\n\n::: {.callout-tip title=\"Insight\"}\n-   Nationally, the middle-aged group forms the majority (61.1%), followed by Youth (20.9%) and Elderly (18%).\n\n-   The top ten planning areas with the highest proportion of elderly residents include Outram, Ang Mo Kio, and Bukit Merah, suggesting these may be aging communities with long-established residential zones.\n\n-   Youth populations are more concentrated in areas such as Changi, Punggol, and Southern Islands, possibly due to lower living costs for younger individuals or proximity to educational institutions. In contrast, central areas like Museum and Downtown Core have the lowest youth representation.\n\n-   Middle-aged individuals dominate areas such as Museum, Seletar, and Downtown Core, where their proportion reaches up to 90%. This may indicate these are employment hubs where middle-aged individuals with stronger spending power tend to reside.\n\n-   Overall, the visualisation reveals clear spatial disparities in age composition across planning areas, highlighting urban ageing, youth clustering in peripheral areas, and middle-aged dominance in central or transitional zones.\n:::\n\n## 3.2 Gender-Based Demographics of Singapore Residents\n\nThis visualisation presents the age and gender structure of Singapore’s population across different planning areas, with each chart highlighting population distribution by gender.\n\n::: panel-tabset\n### The Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-21-1.png){width=960}\n:::\n:::\n\n\n\n### The Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# common theme\ncommon_theme_v2 <- theme(\n  plot.title = element_text(size = 12, \n                            face = \"bold\", \n                            hjust = 0),\n  axis.text.y = element_text(size = 7),\n  legend.position = \"right\"\n)\n\n# p6 \np6 <- ggplot(v2_p6, aes(x = Percent_plot, \n                        y = Age_Group, \n                        fill = Sex)) +\n  geom_col(width = 0.9) +\n  geom_text(\n    data = subset(v2_p6, \n                  Sex == \"Females\"),\n    aes(label = paste0(round(abs(Percent), 2), \"%\")),\n    nudge_x = -2, \n    size = 3.2,\n    color = \"black\"\n  ) +\n  geom_text(\n    data = subset(v2_p6, \n                  Sex == \"Males\"),\n    aes(label = paste0(round(abs(Percent), 2), \"%\")),\n    nudge_x = 2,  \n    size = 3.2,\n    color = \"black\"\n  ) +\n  \n  scale_x_continuous(labels = function(x) paste0(abs(x), \"%\")) +\n  scale_fill_manual(values = c(\"Males\" = \"#58c3c3\", \n                               \"Females\" = \"#f08080\")) +\n  labs(\n    title = \"Population Pyramid: Singapore\",\n    x = \"Percentage of Population (%)\",\n    y = \"Age Group\",\n    fill = \"Sex\"\n  ) +\n  coord_cartesian(xlim = c(-8, 8)) +  \n  theme_minimal() +\n  common_theme_v2\n\n#p7\np7 <- ggplot(v2_p7, \n             aes(x = Percent_plot, \n                        y = PA, \n                        fill = Sex)) +\n  geom_col(width = 0.8) +\n  geom_text(aes(label = round(abs(Percent), 1)),\n            position = position_stack(vjust = 0.5),\n            size = 3, color = \"black\") +\n  scale_x_continuous(limits = c(-60, 60),\n                     labels = function(x) paste0(abs(x), \"%\")) +\n  scale_fill_manual(values = c(\"Males\" = \"#58c3c3\", \n                               \"Females\" = \"#f08080\")) +\n  labs(\n    title = \"Gender Composition by Planning Area\",\n    x = \"Percentage of Population (%)\",\n    y = \"Planning Area\",\n    fill = \"Sex\"\n  ) +\n  theme_minimal() +\n  common_theme_v2\n\n# p8\np8 <- ggplot(v2_p8, aes(x = Elderly_Rate_plot, \n                        y = PA, \n                        fill = Sex)) +\n  geom_col(width = 0.8) +\n  geom_text(\n    data = subset(v2_p8, \n                  Sex == \"Females\"),\n    aes(label = paste0(round(abs(Elderly_Rate), 1), \"%\")),\n    nudge_x = -9,\n    size = 3,\n    color = \"black\"\n  ) +\n  \n  geom_text(\n    data = subset(v2_p8, \n                  Sex == \"Males\"),\n    aes(label = paste0(round(abs(Elderly_Rate), 1), \"%\")),\n    nudge_x = 9,\n    size = 3,\n    color = \"black\"\n  ) +\n  scale_x_continuous(labels = function(x) paste0(abs(x), \"%\")) +\n  scale_fill_manual(values = c(\"Males\" = \"#58c3c3\", \n                               \"Females\" = \"#f08080\")) +\n  labs(\n    title = \"Top 10 & Bottom 10 Areas by Elderly Rate\\n(≥ 65) by Gender\",\n    x = \"Elderly Population Ratio (%)\",\n    y = \"Planning Area\",\n    fill = \"Sex\"\n  ) +\n    coord_cartesian(xlim = c(-50, 50)) +  \n  theme_minimal() +\n  common_theme_v2\n\n\n(p6 / p8) | p7\n```\n:::\n\n\n:::\n\n::: {.callout-tip title=\"Insight\"}\n-   The population pyramid in the top-left shows the proportion of males and females across various age groups. The gender ratio is relatively balanced below age 64, but females significantly outnumber males in the 65 and above age groups, suggesting a larger elderly female population likely due to longer life expectancy.\n\n-   The chart on the right displays the gender composition by planning area. In most areas, females slightly outnumber males, with the highest female proportions found in Orchard (56.3%), Western Water Catchment (55.9%), and Seletar (57.1%). In contrast, areas like Sungei Kadut and Changi have higher male proportions, possibly due to the dominance of male-oriented industries in those regions.\n\n-   The bottom-left chart presents the top 10 and bottom 10 areas by elderly population ratio (≥65), disaggregated by gender. Outram, Ang Mo Kio, and Rochor have the highest elderly ratios, and females consistently make up a larger share of the elderly population, further highlighting gendered ageing trends.\n\n-   Overall, the visualisation reveals a gender imbalance among the elderly, with females forming the majority, and illustrates regional differences in gender and age distribution—providing important insights for planning in healthcare, housing, and social services.\n:::\n\n## 3.3 Population Structure Across Singapore Regions\n\nThis visualization presents the population size, gender, and age distribution across the five main regions of Singapore: Central, East, North, North-East, and West.\n\n::: panel-tabset\n### The Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-23-1.png){width=960}\n:::\n:::\n\n\n\n### The Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# theme\ncommon_theme_v3 <- theme_minimal() +\n  theme(\n    plot.title = element_text(face = \"bold\", \n                              size = 14, \n                              hjust = 0.5),\n    axis.title = element_text(size = 12),\n    axis.text = element_text(size = 10),\n    legend.position = \"top\"\n  )\n\n\n# p9\np9 <- ggplot(v3_p9, aes(x = 2, \n                        y = Total_Pop, \n                        fill = Region)) +\n  geom_col(width = 1, \n           color = \"white\") +\n  coord_polar(theta = \"y\") +\n  xlim(c(1, 2.5)) + \n  geom_text(\n    aes(label = Label),\n    position = position_stack(vjust = 0.5),\n    size = 3\n  ) +\n  labs(title = \"Population Distribution by Region\") +\n  theme_void() +\n  theme(\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    legend.position = \"none\"\n  ) +\n  scale_fill_brewer(palette = \"Set3\")\n\n  \n  \n\n# p10\np10 <- ggplot(v3_p10, \n              aes(x = Age, \n                  y = Region, \n                  fill = Sex)) +\n  geom_density_ridges(\n    alpha = 0.5,\n    scale = 1.2,\n    color = \"white\",\n    position = \"identity\"\n  ) +\n  scale_fill_manual(values = c(\"Males\" = \"#58c3c3\", \n                               \"Females\" = \"#f08080\")) +\n  scale_x_continuous(breaks = seq(0, 90, by = 10), limits = c(0, 90)) + \n  labs(\n    title = \"Age Distribution by Region\",\n    x = NULL,\n    y = NULL,\n    fill = NULL\n  ) +\n  theme_minimal() +\n  common_theme_v3 \n\n# p11\np11 <- ggplot() +\n  geom_boxplot(\n    data = v3_p10,\n    aes(x = Region, \n        y = Age, \n        color = Sex),\n    position = position_dodge(width = 0.75),\n  ) +\n  geom_point(\n    data = v3_p11,\n    aes(x = Region, \n        y = Age, \n        color = Sex),\n    position = position_jitterdodge(jitter.width = 0.3, \n                                    dodge.width = 0.75),\n    size = 0.5,\n    alpha = 0.4\n  ) +\n  scale_color_manual(values = c(\"Males\" = \"#58c3c3\", \n                                \"Females\" = \"#f08080\")) +\n  scale_y_continuous(breaks = seq(0, 90, by = 10), limits = c(0, 90))+\n  labs(\n    title = \"Age Distribution by Region and Gender\",\n    x = NULL,\n    y = NULL,\n    color = NULL\n  ) +\n  theme_minimal() +\n  common_theme_v3\n\n\np12 <- ggplot(v3_ridges, aes(x = Age, y = fct_rev(Region), \n                             fill = Region)) +\n  geom_density_ridges(scale = 0.9, \n                      alpha = 0.6, \n                      color = \"black\") +\n\n  geom_jitter(data = v3_points,\n              aes(x = Age, \n                  y = Region_numeric + 0.25, \n                  color = Region),\n              height = 0.2, \n              width = 0, \n              size = 0.05, \n              alpha = 0.6,\n              inherit.aes = FALSE) +\n  \n  scale_fill_brewer(palette = \"Set3\") +\n  scale_color_brewer(palette = \"Dark2\") +\n  scale_x_continuous(breaks = seq(0, 90, by = 10), limits = c(0, 90)) + \n  labs(\n    title = \"Age Distribution Across Regions in Singapore\",\n      x = NULL,\n    y = NULL\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.title.x = element_text(hjust = 1),\n    plot.title = element_text(face = \"bold\", size = 14),\n  )\n\n\na <- (p9 + p10) / (p11+p12)\na \n```\n:::\n\n\n:::\n\n::: {.callout-tip title=\"Insight\"}\n-   The pie chart in the top-left shows that Singapore’s population is relatively evenly distributed across regions, with the North-East and Central areas having the highest populations, while the North has the smallest.\n\n-   The top-right visualisation displays the age distribution by gender across different regions. The age density curve for the Central region skews noticeably to the right, peaking above age 50, indicating a higher proportion of elderly residents. In the West and North-East, the 25 to 45 age group is more prominent. Across all regions, females aged 75 and above outnumber males, consistent with higher female life expectancy.\n\n-   The bottom-left chart illustrates the age distribution by gender within each region. The Central region stands out as the most aged. The East and North show narrower boxplots, indicating more concentrated age distributions, possibly reflecting more stable and mature communities. Overall, similar interquartile ranges suggest a generally balanced age structure across regions.\n\n-   The bottom-right chart further highlights intra-regional differences, with higher elderly population densities in the Central and Eastern regions. These patterns suggest that although all regions span a wide age range, some may be aging more rapidly, which could influence regional planning and healthcare needs.\n:::\n\n# 4 Conclusion\n\nBased on a comprehensive visual analysis of the population structure across Singapore’s planning areas, the study reveals significant spatial disparities in demographic composition. In terms of age, the middle-aged population (22 to 64 years) forms the majority at 61.1%, though this proportion varies considerably across districts. Elderly populations are predominantly concentrated in long-established central areas such as Outram and Ang Mo Kio, while younger populations are more commonly found in peripheral or transitional areas like Punggol and Changi. Middle-aged residents are mainly located in economically active zones such as the Downtown Core and Museum area, reflecting functional differences among regions.\n\nGender structure analysis shows that although the sex ratio among younger age groups is relatively balanced, females significantly outnumber males in the elderly population, reflecting longer female life expectancy. Regionally, the Central area is characterized by both a high degree of ageing and a female-majority population. In contrast, the West and North regions exhibit more balanced gender distributions, which may be associated with the presence of male-dominated, labor-intensive industries.\n\nIn conclusion, the analysis highlights two key demographic trends—population ageing and gender imbalance—and underscores the need for regionally differentiated strategies in urban planning, healthcare resource allocation, and the provision of social services.\n\n# 5 Reference\n\n-   Kam, Tin Seong. (2023). Visualising Distribution. *R for Visual Analytics.* <https://r4va.netlify.app/chap09>\n\n-   Hadley Wickham (2023) [**ggplot2: Elegant Graphics for Data Analysis**](https://ggplot2-book.org/). Online 3rd edition.\n\n-   Winston Chang (2013) [**R Graphics Cookbook 2nd edition**](https://r-graphics.org/). Online version.\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}